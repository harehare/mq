include "csv"

| let input = "a,b,c\n\"1,2\",\"2,3\",\"3,4\"\n4,5,6\n\"multi\nline\",7,8\n9,10,\"quoted,comma\"\n\"\",11,12\n13,14,15\n"
| def test_csv_parse_for_dict():
    let result = csv_parse(input, true)
    | assert(len(result) == 6)
  end

| def test_csv_to_json_for_dict():
    let result = csv_to_json(csv_parse(input, true))
    | assert(result == "[{\"a\":\"1,2\",\"b\":\"2,3\",\"c\":\"3,4\"},{\"a\":\"4\",\"b\":\"5\",\"c\":\"6\"},{\"a\":\"multi\nline\",\"b\":\"7\",\"c\":\"8\"},{\"a\":\"9\",\"b\":\"10\",\"c\":\"quoted,comma\"},{\"a\":\"\",\"b\":\"11\",\"c\":\"12\"},{\"a\":\"13\",\"b\":\"14\",\"c\":\"15\"}]")
  end

| def test_csv_parse_for_array():
    let result = csv_parse(input, false)
    | assert(len(result) == 7)
  end

| def test_csv_to_json_for_array():
    let result = csv_to_json(csv_parse(input, false))
    | assert(result == "[[\"a\",\"b\",\"c\"],[\"1,2\",\"2,3\",\"3,4\"],[\"4\",\"5\",\"6\"],[\"multi\nline\",\"7\",\"8\"],[\"9\",\"10\",\"quoted,comma\"],[\"\",\"11\",\"12\"],[\"13\",\"14\",\"15\"]]")
  end

| test_csv_parse_for_dict()
| test_csv_to_json_for_dict()
| test_csv_parse_for_array()
| test_csv_to_json_for_array()
| "âœ… All CSV tests passed successfully! ğŸš€"
